<!DOCTYPE html>  
<html lang="es">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>EvaCare V13.1 - Fast Validation</title>  
    <script src="https://cdn.tailwindcss.com"></script>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">  
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>  
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap');  
        body { font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }  
        .hidden { display: none !important; }  
        .card { background: white; border-radius: 1.5rem; padding: 1.2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }  
        input { border: 2px solid transparent !important; transition: all 0.3s; }
        input:focus { border-color: #2563eb !important; background: white !important; }
        .btn-reac-active { background-color: #ffedd5 !important; border: 2px solid #f97316 !important; }
        .cal-day { aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; border-radius: 0.8rem; font-size: 0.8rem; font-weight: 700; position: relative; }
        .hoy { background-color: #2563eb !important; color: white !important; }
        .seleccionado { border: 2px solid #2563eb !important; }
    </style>  
</head>  
<body class="bg-slate-50 text-slate-900 pb-28">

<div id="loading-screen" class="fixed inset-0 bg-white z-[9000] flex flex-col items-center justify-center text-center p-6">
    <div class="text-blue-600 text-4xl font-black italic animate-pulse mb-2">EvaCare</div>
    <div id="loading-text" class="text-[10px] font-bold text-slate-300 tracking-widest uppercase">Cargando...</div>
</div>

<div id="setup-wizard" class="fixed inset-0 bg-white z-[8000] flex flex-col p-8 hidden overflow-y-auto">  
    <div id="step-0" class="step-div flex flex-col h-full justify-center space-y-8">
        <div class="text-center">
            <h2 class="text-4xl font-black italic text-blue-600">EvaCare</h2>
            <p class="text-slate-400 font-bold text-xs mt-2 uppercase tracking-tighter">Gesti√≥n Compartida</p>
        </div>
        <div class="space-y-4">
            <button onclick="irAStep('join')" class="w-full bg-slate-900 text-white p-6 rounded-[2rem] font-black flex items-center justify-between">
                <div class="text-left"><span class="block text-lg">Unirse a Familia</span><span class="text-[9px] opacity-50 uppercase">Ya tengo un c√≥digo</span></div>
                <i class="fa-solid fa-arrow-right mr-2"></i>
            </button>
            <button onclick="irAStep(1)" class="w-full bg-blue-600 text-white p-6 rounded-[2rem] font-black flex items-center justify-between">
                <div class="text-left"><span class="block text-lg">Nueva Familia</span><span class="text-[9px] opacity-70 uppercase">Registrar hoy</span></div>
                <i class="fa-solid fa-plus mr-2"></i>
            </button>
        </div>
    </div>

    <div id="step-join" class="step-div hidden flex flex-col h-full justify-center space-y-6">
        <h2 class="text-3xl font-black italic">ID Familiar</h2>
        <input id="join-id" type="text" placeholder="C√≥digo de familia" class="w-full p-6 bg-slate-100 rounded-3xl text-xl font-bold outline-none">
        <button onclick="processJoin()" class="bg-slate-900 text-white p-6 rounded-3xl font-black uppercase">Entrar</button>
        <button onclick="irAStep(0)" class="text-slate-400 font-bold text-sm">Atr√°s</button>
    </div>

    <div id="step-1" class="step-div hidden flex flex-col h-full justify-center space-y-6">  
        <h2 class="text-3xl font-black italic">Crear ID</h2>  
        <input id="setup-family" type="text" placeholder="Ej: FamiliaGarcia" class="w-full p-6 bg-slate-100 rounded-3xl text-xl font-bold outline-none">
        <button onclick="irAStep(2)" class="bg-blue-600 text-white p-6 rounded-3xl font-black uppercase">Siguiente</button>  
        <button onclick="irAStep(0)" class="text-slate-400 font-bold text-sm">Volver</button>
    </div>  

    <div id="step-2" class="step-div hidden flex flex-col h-full justify-center space-y-6">  
        <h2 class="text-3xl font-black">Nombre del Beb√©</h2>  
        <input id="setup-n" type="text" placeholder="¬øC√≥mo se llama?" class="w-full p-6 bg-slate-100 rounded-3xl text-2xl font-bold outline-none">  
        <button onclick="irAStep(3)" class="bg-blue-600 text-white p-6 rounded-3xl font-black uppercase">Siguiente</button>  
    </div>  

    <div id="step-3" class="step-div hidden flex flex-col h-full justify-center space-y-6">  
        <h2 class="text-3xl font-black">Fecha Nacimiento</h2>  
        <input id="setup-f" type="date" class="w-full p-6 bg-slate-100 rounded-3xl text-xl font-bold outline-none">  
        <button onclick="finishCreate()" class="bg-slate-900 text-white p-6 rounded-3xl font-black uppercase">Finalizar</button>  
    </div>  
</div>  

<div id="app-content" class="hidden">
    <nav class="fixed bottom-6 left-6 right-6 h-16 bg-white/90 backdrop-blur-xl rounded-full border border-slate-100 shadow-2xl flex justify-around items-center z-50">  
        <button onclick="showTab('inicio')" id="nav-inicio" class="text-blue-600 p-4"><i class="fa-solid fa-house-chimney"></i></button>  
        <button onclick="showTab('nutricion')" id="nav-nutricion" class="text-slate-300 p-4"><i class="fa-solid fa-carrot"></i></button>  
        <button onclick="showTab('salud')" id="nav-salud" class="text-slate-300 p-4"><i class="fa-solid fa-suitcase-medical"></i></button>  
        <button onclick="showTab('cal')" id="nav-cal" class="text-slate-300 p-4"><i class="fa-solid fa-calendar-day"></i></button>  
    </nav>  

    <main id="tab-inicio" class="p-4 space-y-4 pt-6">  
        <header class="flex justify-between items-center px-2">  
            <span class="text-2xl font-extrabold text-slate-900 italic">EvaCare</span>  
            <button onclick="openModal('modal-menu')" class="text-slate-300"><i class="fa-solid fa-bars-staggered"></i></button>  
        </header>  
        <div class="bg-blue-600 p-6 rounded-[2.5rem] text-white shadow-xl relative overflow-hidden">  
            <h2 id="view-nombre" class="text-2xl font-black italic uppercase relative z-10">---</h2>  
            <p id="view-edad" class="text-[10px] font-bold opacity-70 tracking-widest mt-1 uppercase relative z-10"></p>  
            <i class="fa-solid fa-baby absolute -right-2 -bottom-2 text-7xl opacity-10"></i>
        </div>  
        <div class="bg-slate-900 rounded-[2rem] p-5 text-white shadow-2xl text-center"><div id="timeline-eventos" class="text-sm font-bold text-blue-400 italic italic">Cargando...</div></div>  
        <div id="lista-compra" class="hidden space-y-2"></div>
        <div class="grid grid-cols-4 gap-2">  
            <button onclick="addLog('üí¶ Pis')" class="bg-white py-5 rounded-3xl font-black text-cyan-600 text-[10px] border">PIS</button>  
            <button onclick="addLog('üí© Caca')" class="bg-white py-5 rounded-3xl font-black text-orange-800 text-[10px] border">CACA</button>  
            <button onclick="addLog('‚ú® Aseo')" class="bg-white py-5 rounded-3xl font-black text-purple-600 text-[10px] border">ASEO</button>  
            <button onclick="addCompraUrgent()" class="bg-yellow-400 text-slate-900 rounded-3xl flex items-center justify-center shadow-lg"><i class="fa-solid fa-cart-plus"></i></button>  
        </div>  
        <div class="grid grid-cols-2 gap-4">  
            <button onclick="openModal('modal-pecho')" class="bg-white h-24 rounded-[2rem] flex flex-col items-center justify-center border shadow-sm"><i class="fa-solid fa-person-breastfeeding text-pink-500 mb-1 text-xl"></i><span class="text-[9px] font-black uppercase">Pecho</span></button>  
            <button onclick="openModal('modal-bibe')" class="bg-white h-24 rounded-[2rem] flex flex-col items-center justify-center border shadow-sm"><i class="fa-solid fa-bottle-water text-blue-500 mb-1 text-xl"></i><span class="text-[9px] font-black uppercase">Biber√≥n</span></button>  
        </div>  
        <div id="diario-hoy" class="space-y-2 pb-10"></div>  
    </main>

    <main id="tab-nutricion" class="hidden p-4 space-y-4 pt-6"><h2 class="text-2xl font-black italic text-orange-600">Nutrici√≥n</h2><div class="bg-white p-6 rounded-3xl space-y-4 shadow-sm border"><input id="food-n" type="text" placeholder="Alimento..." class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none"><div class="grid grid-cols-2 gap-4"><button onclick="setReac('üòã', this)" class="btn-reac bg-slate-50 p-4 rounded-2xl text-2xl">üòã</button><button onclick="setReac('ü§¢', this)" class="btn-reac bg-slate-50 p-4 rounded-2xl text-2xl">ü§¢</button></div><button onclick="saveFood()" class="w-full bg-orange-500 text-white p-4 rounded-2xl font-black uppercase text-[10px]">Guardar</button></div><div id="lista-alimentos" class="space-y-2"></div></main>
    <main id="tab-salud" class="hidden p-4 space-y-4 pt-6"><h2 class="text-2xl font-black italic text-indigo-600">Salud</h2><button onclick="openModal('modal-add-med')" class="w-full bg-indigo-600 text-white p-5 rounded-3xl font-black shadow-lg">Nuevo Tratamiento</button><div id="lista-salud" class="space-y-3"></div></main>
    <main id="tab-cal" class="hidden p-4 space-y-6 pt-6"><h2 class="text-2xl font-black italic text-blue-600">Agenda</h2><div class="bg-white p-4 rounded-3xl shadow-sm border"><div class="flex justify-between items-center mb-4"><button onclick="changeMonth(-1)"><i class="fa-solid fa-chevron-left"></i></button><h3 id="cal-mes-titulo" class="font-black uppercase text-xs"></h3><button onclick="changeMonth(1)"><i class="fa-solid fa-chevron-right"></i></button></div><div id="cal-grid" class="grid grid-cols-7 gap-1"></div></div><div id="agenda-total-lista" class="space-y-2 pb-10"></div></main>
</div>

<div id="modal-menu" class="hidden fixed inset-0 bg-black/80 z-[9500] flex justify-end"><div class="bg-white w-4/5 h-full p-8 flex flex-col"><h2 class="text-3xl font-black italic mb-10">Ajustes</h2><div class="space-y-4"><div class="bg-slate-50 p-5 rounded-3xl"><p class="text-[9px] font-black text-blue-600 mb-1 uppercase tracking-widest">ID Familia</p><p id="view-family-id" class="font-bold text-slate-800 break-all text-xs"></p></div><div class="bg-slate-50 p-5 rounded-3xl"><p class="text-[9px] font-black text-blue-600 mb-2 uppercase tracking-widest">Plazo Tomas</p><div class="flex items-center justify-between"><button onclick="updatePlazo(-0.5)" class="text-blue-600 font-bold p-2 text-xl">-</button><span id="view-plazo" class="font-black text-slate-800 text-lg">3h</span><button onclick="updatePlazo(0.5)" class="text-blue-600 font-bold p-2 text-xl">+</button></div></div></div><button onclick="reiniciarApp()" class="w-full mt-10 text-red-500 p-4 border border-red-50 rounded-2xl font-bold text-[10px] uppercase">Cerrar Sesi√≥n</button><button onclick="closeModal('modal-menu')" class="mt-auto p-4 text-slate-300 text-center font-bold text-xs">CERRAR</button></div></div>
<div id="modal-bibe" class="hidden fixed inset-0 bg-black/80 z-[9500] flex items-center justify-center p-6"><div class="bg-white w-full rounded-[2.5rem] p-8 space-y-4"><input id
